<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>ImportExport (gearTracker-ml.GearTracker_ml.ImportExport)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">gearTracker-ml</a> &#x00BB; <a href="../index.html">GearTracker_ml</a> &#x00BB; ImportExport</nav><header class="odoc-preamble"><h1>Module <code><span>GearTracker_ml.ImportExport</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#export-functions">Export Functions</a></li><li><a href="#import-functions">Import Functions</a></li><li><a href="#utility-functions">Utility Functions</a></li></ul></nav></div><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-export_options"><a href="#type-export_options" class="anchor"></a><code><span><span class="keyword">type</span> export_options</span><span> = </span><span>{</span></code><ol><li id="type-export_options.include_firearms" class="def record field anchored"><a href="#type-export_options.include_firearms" class="anchor"></a><code><span>include_firearms : bool;</span></code></li><li id="type-export_options.include_gear" class="def record field anchored"><a href="#type-export_options.include_gear" class="anchor"></a><code><span>include_gear : bool;</span></code></li><li id="type-export_options.include_nfa_items" class="def record field anchored"><a href="#type-export_options.include_nfa_items" class="anchor"></a><code><span>include_nfa_items : bool;</span></code></li><li id="type-export_options.include_attachments" class="def record field anchored"><a href="#type-export_options.include_attachments" class="anchor"></a><code><span>include_attachments : bool;</span></code></li><li id="type-export_options.include_consumables" class="def record field anchored"><a href="#type-export_options.include_consumables" class="anchor"></a><code><span>include_consumables : bool;</span></code></li><li id="type-export_options.include_reload_batches" class="def record field anchored"><a href="#type-export_options.include_reload_batches" class="anchor"></a><code><span>include_reload_batches : bool;</span></code></li><li id="type-export_options.include_loadouts" class="def record field anchored"><a href="#type-export_options.include_loadouts" class="anchor"></a><code><span>include_loadouts : bool;</span></code></li><li id="type-export_options.include_checkouts" class="def record field anchored"><a href="#type-export_options.include_checkouts" class="anchor"></a><code><span>include_checkouts : bool;</span></code></li><li id="type-export_options.include_borrowers" class="def record field anchored"><a href="#type-export_options.include_borrowers" class="anchor"></a><code><span>include_borrowers : bool;</span></code></li><li id="type-export_options.include_transfers" class="def record field anchored"><a href="#type-export_options.include_transfers" class="anchor"></a><code><span>include_transfers : bool;</span></code></li><li id="type-export_options.include_maintenance_logs" class="def record field anchored"><a href="#type-export_options.include_maintenance_logs" class="anchor"></a><code><span>include_maintenance_logs : bool;</span></code></li><li id="type-export_options.include_consumable_transactions" class="def record field anchored"><a href="#type-export_options.include_consumable_transactions" class="anchor"></a><code><span>include_consumable_transactions : bool;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Export options for selective data export</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_export_options"><a href="#val-default_export_options" class="anchor"></a><code><span><span class="keyword">val</span> default_export_options : <a href="#type-export_options">export_options</a></span></code></div><div class="spec-doc"><p>Default export options with all entities enabled</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-import_action"><a href="#type-import_action" class="anchor"></a><code><span><span class="keyword">type</span> import_action</span><span> = </span></code><ol><li id="type-import_action.Skip" class="def variant constructor anchored"><a href="#type-import_action.Skip" class="anchor"></a><code><span>| </span><span><span class="constructor">Skip</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Skip the duplicate record</p><span class="comment-delim">*)</span></div></li><li id="type-import_action.Overwrite" class="def variant constructor anchored"><a href="#type-import_action.Overwrite" class="anchor"></a><code><span>| </span><span><span class="constructor">Overwrite</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Overwrite the existing record</p><span class="comment-delim">*)</span></div></li><li id="type-import_action.Import_as_new" class="def variant constructor anchored"><a href="#type-import_action.Import_as_new" class="anchor"></a><code><span>| </span><span><span class="constructor">Import_as_new</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Import as a new record with a new ID</p><span class="comment-delim">*)</span></div></li><li id="type-import_action.Cancel" class="def variant constructor anchored"><a href="#type-import_action.Cancel" class="anchor"></a><code><span>| </span><span><span class="constructor">Cancel</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Cancel the entire import</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Action to take when a duplicate is encountered during import</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-duplicate_info"><a href="#type-duplicate_info" class="anchor"></a><code><span><span class="keyword">type</span> duplicate_info</span><span> = </span><span>{</span></code><ol><li id="type-duplicate_info.entity_type" class="def record field anchored"><a href="#type-duplicate_info.entity_type" class="anchor"></a><code><span>entity_type : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Type of entity (firearm, gear, etc.)</p><span class="comment-delim">*)</span></div></li><li id="type-duplicate_info.id" class="def record field anchored"><a href="#type-duplicate_info.id" class="anchor"></a><code><span>id : <a href="../Id/index.html#type-t">Id.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>ID of the record</p><span class="comment-delim">*)</span></div></li><li id="type-duplicate_info.name" class="def record field anchored"><a href="#type-duplicate_info.name" class="anchor"></a><code><span>name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Name/display value</p><span class="comment-delim">*)</span></div></li><li id="type-duplicate_info.existing_record" class="def record field anchored"><a href="#type-duplicate_info.existing_record" class="anchor"></a><code><span>existing_record : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Description of existing record</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Information about a duplicate record</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-entity_stats"><a href="#type-entity_stats" class="anchor"></a><code><span><span class="keyword">type</span> entity_stats</span><span> = </span><span>{</span></code><ol><li id="type-entity_stats.total_rows" class="def record field anchored"><a href="#type-entity_stats.total_rows" class="anchor"></a><code><span>total_rows : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Total number of rows processed</p><span class="comment-delim">*)</span></div></li><li id="type-entity_stats.imported" class="def record field anchored"><a href="#type-entity_stats.imported" class="anchor"></a><code><span>imported : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Number of new records imported</p><span class="comment-delim">*)</span></div></li><li id="type-entity_stats.skipped" class="def record field anchored"><a href="#type-entity_stats.skipped" class="anchor"></a><code><span>skipped : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Number of duplicates skipped</p><span class="comment-delim">*)</span></div></li><li id="type-entity_stats.overwritten" class="def record field anchored"><a href="#type-entity_stats.overwritten" class="anchor"></a><code><span>overwritten : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Number of existing records overwritten</p><span class="comment-delim">*)</span></div></li><li id="type-entity_stats.errors" class="def record field anchored"><a href="#type-entity_stats.errors" class="anchor"></a><code><span>errors : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Number of rows with errors</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Statistics for a single entity type during import</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-import_error_detail"><a href="#type-import_error_detail" class="anchor"></a><code><span><span class="keyword">type</span> import_error_detail</span><span> = </span><span>{</span></code><ol><li id="type-import_error_detail.error_section" class="def record field anchored"><a href="#type-import_error_detail.error_section" class="anchor"></a><code><span>error_section : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Section name where error occurred</p><span class="comment-delim">*)</span></div></li><li id="type-import_error_detail.error_row" class="def record field anchored"><a href="#type-import_error_detail.error_row" class="anchor"></a><code><span>error_row : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Row number (1-based, excluding header)</p><span class="comment-delim">*)</span></div></li><li id="type-import_error_detail.error_messages" class="def record field anchored"><a href="#type-import_error_detail.error_messages" class="anchor"></a><code><span>error_messages : <span>string list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>List of error messages</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Detailed information about a specific import error</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-import_result"><a href="#type-import_result" class="anchor"></a><code><span><span class="keyword">type</span> import_result</span><span> = </span><span>{</span></code><ol><li id="type-import_result.success" class="def record field anchored"><a href="#type-import_result.success" class="anchor"></a><code><span>success : bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Whether import completed successfully</p><span class="comment-delim">*)</span></div></li><li id="type-import_result.overall_stats" class="def record field anchored"><a href="#type-import_result.overall_stats" class="anchor"></a><code><span>overall_stats : <a href="#type-entity_stats">entity_stats</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Aggregated statistics across all entities</p><span class="comment-delim">*)</span></div></li><li id="type-import_result.entity_stats" class="def record field anchored"><a href="#type-import_result.entity_stats" class="anchor"></a><code><span>entity_stats : <span><span>(string * <a href="#type-entity_stats">entity_stats</a>)</span> list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Per-entity statistics</p><span class="comment-delim">*)</span></div></li><li id="type-import_result.error_details" class="def record field anchored"><a href="#type-import_result.error_details" class="anchor"></a><code><span>error_details : <span><a href="#type-import_error_detail">import_error_detail</a> list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Detailed error information</p><span class="comment-delim">*)</span></div></li><li id="type-import_result.cancelled" class="def record field anchored"><a href="#type-import_result.cancelled" class="anchor"></a><code><span>cancelled : bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Whether import was cancelled</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Result of an import operation</p></div></div><h3 id="export-functions"><a href="#export-functions" class="anchor"></a>Export Functions</h3><div class="odoc-spec"><div class="spec value anchored" id="val-export_firearms_to_csv"><a href="#val-export_firearms_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_firearms_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all firearms to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_soft_gear_to_csv"><a href="#val-export_soft_gear_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_soft_gear_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all soft gear to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_nfa_items_to_csv"><a href="#val-export_nfa_items_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_nfa_items_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all NFA items to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_attachments_to_csv"><a href="#val-export_attachments_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_attachments_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all attachments to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_consumables_to_csv"><a href="#val-export_consumables_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_consumables_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all consumables to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_reload_batches_to_csv"><a href="#val-export_reload_batches_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_reload_batches_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all reload batches to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_borrowers_to_csv"><a href="#val-export_borrowers_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_borrowers_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all borrowers to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_checkouts_to_csv"><a href="#val-export_checkouts_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_checkouts_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all checkouts to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_transfers_to_csv"><a href="#val-export_transfers_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_transfers_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all transfers to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_maintenance_logs_to_csv"><a href="#val-export_maintenance_logs_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_maintenance_logs_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all maintenance logs to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_loadouts_to_csv"><a href="#val-export_loadouts_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_loadouts_to_csv : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export all loadouts to CSV format</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>CSV string or error</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-export_all_to_csv"><a href="#val-export_all_to_csv" class="anchor"></a><code><span><span class="keyword">val</span> export_all_to_csv : 
  <span><span class="label">path</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">options</span>:<a href="#type-export_options">export_options</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(unit, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Export complete database to sectioned CSV file</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">path</span> <p>Output file path</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">options</span> <p>Export options to control which entities to include</p></li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>unit or error</p></li></ul></div></div><h3 id="import-functions"><a href="#import-functions" class="anchor"></a>Import Functions</h3><div class="odoc-spec"><div class="spec value anchored" id="val-import_all_from_csv"><a href="#val-import_all_from_csv" class="anchor"></a><code><span><span class="keyword">val</span> import_all_from_csv : 
  <span><span class="label">path</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dry_run</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">on_duplicate</span>:<span>(<span><a href="#type-duplicate_info">duplicate_info</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-import_action">import_action</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-import_result">import_result</a>, <a href="../Error/index.html#type-t">Error.t</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Import all entities from a sectioned CSV file</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">path</span> <p>Input file path</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">dry_run</span> <p>If true, validate without importing</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">on_duplicate</span> <p>Callback function to handle duplicates</p></li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>Import result or error</p></li></ul></div></div><h3 id="utility-functions"><a href="#utility-functions" class="anchor"></a>Utility Functions</h3><div class="odoc-spec"><div class="spec value anchored" id="val-parse_sectioned_csv"><a href="#val-parse_sectioned_csv" class="anchor"></a><code><span><span class="keyword">val</span> parse_sectioned_csv : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(string * <span><span>string list</span> list</span>)</span> list</span></span></code></div><div class="spec-doc"><p>Parse a sectioned CSV file into sections</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">path</span> <p>Input file path</p></li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>List of (section_name, rows) tuples</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-escape_csv_field"><a href="#val-escape_csv_field" class="anchor"></a><code><span><span class="keyword">val</span> escape_csv_field : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Escape a field for CSV output</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">s</span> <p>Field value</p></li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>Escaped field string</p></li></ul></div></div></div></body></html>
